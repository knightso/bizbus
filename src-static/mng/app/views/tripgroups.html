<div class="panel panel-default">
  <div class="panel-body">
    <a ui-sref="agencies.detail.routes.detail.tripgroups.post({agencyId: agency.id, routeId: route.id})"><button type="button" class="btn btn-primary btn-sm glyphicon glyphicon-plus">追加</button></a>
    <button type="button" class="btn btn-primary btn-sm glyphicon glyphicon-search" ng-click="filtering=!filtering">フィルタ</button>
  </div>
  <table class="table">
    <thead ng-show="filtering">
      <th><input type="text" size="10" ng-model="criteria.id" class="form-control" placeholder="TgID"></th>
      <th><input type="text" size="10" ng-model="criteria.routeId" class="form-control" placeholder="RouteId"></th>
      <th><input type="text" size="20" ng-model="criteria.desc" class="form-control" placeholder="Desc"></th>
      <th>
        <select name="directionId" ng-model="criteria.directionId" class="form-control" 
          ng-options="dType.id as dType.name for dType in directionTypes" 
          ng-change="criteria.directionId = criteria.directionId ? criteria.directionId : undefined">
          <option value="">------</option>
        </select>
      </th>
      <th><input type="text" size="20" ng-model="criteria.defaultHeadsign" class="form-control" placeholder="DefaultHeadsign"></th>
      <th></th>
      <th><button type="button" class="btn btn-primary btn-sm glyphicon glyphicon-remove-sign" ng-click="criteria={}"></button></th>
    </thead>
    <thead style="background-color: #ddd">
      <th>TgID</th>
      <th>RouteID</th>
      <th>Desc</th>
      <th>Direction</th>
      <th>DefaultHeadsign</th>
      <th>Stops</th>
      <th>Trips</th>
    </thead>
    <tbody>
      <tr ng-repeat="tg in tripgroups | filter:(filtering ? criteria : {})" ng-click="detail(agency.id, route.id, tg.id)" class="selectable" ng-class-even="'even'">
        <td>{{tg.id}}</td>
        <td>{{tg.routeId}}</td>
        <td>{{tg.desc | limitTo:charLimit}}<span ng-show="tg.desc.length > charLimit">...</span></td>
        <td>{{tg.directionId | directionType}}</td>
        <td>{{tg.defaultHeadsign}}</td>
        <td><a ui-sref="agencies.detail.routes.detail.tripgroups.detail.stops({agencyId: agency.id, routeId: route.id, tripgroupId: tg.id})"><button type="button" class="btn btn-primary btn-sm glyphicon glyphicon-list">&nbsp;{{tg.stops.length}}</button></a></td>
        <td><a ui-sref="agencies.detail.routes.detail.tripgroups.detail.trips({agencyId: agency.id, routeId: route.id, tripgroupId: tg.id})"><button type="button" class="btn btn-primary btn-sm glyphicon glyphicon-list">&nbsp;9(Todo)<!--TODO--></button></a></td>
    </tr>
    </tbody>
  </table>
</div>
<div class="panel-body">
  <a ui-sref="agencies.detail.routes.detail.tripgroups.post({agencyId: agency.id, routeId: route.id})"><button type="button" class="btn btn-primary btn-sm glyphicon glyphicon-plus">追加</button></a>
</div>
